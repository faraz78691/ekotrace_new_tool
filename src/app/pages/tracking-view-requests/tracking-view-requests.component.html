<div class="container-fluid">
    <div class="d-flex justify-content-center"></div>
    <div class="row d-flex justify-content-center mx-3 my-2">
      
    </div>
    <div class="row pt-2 text-white">
        <div class="col mx-4 border rounded Dashboard-tab view-request-col">
            <form #sendApprovalForm="ngForm">
                <div class="row mx-2 border-bottom mt-3 pb-3">

                    <div class="row d-flex align-items-center ml-0 gap-3 ct_drop_input_250123">

                        <p-dropdown class="ct_custom_drop_white ct_input_dark_text_14 ct_chev_icon_dark230 " ngModel
                            [options]="AllCategory" optionLabel="catName" optionValue="id" name="DEMode"
                            #DEMode="ngModel" [(ngModel)]="selectedCategory" (onChange)="getEntry()"></p-dropdown>
                            <div class="col-md-6" *ngIf="modeShow">
                                
                                <p-dropdown class="ct_input_white_bg13 ct_select_2_drop_white ct_input_dark_text_145"
                                    [options]="Modes" defaultLabel="Select Data Points" [(ngModel)]="selectMode"
                                    optionLabel="modeType" optionValue="id" name="datapoint" (onChange)="getModesEntry()"></p-dropdown>
                            </div>
                        <div class=" ml-2 ct_calander_600_height_38">
                            <p-calendar class="ct_calender_input_1234   ct_calander_input_box_white_bg20" ngModel
                                name="year" year [(ngModel)]="year" styleClass="pcalender" view="year" dateFormat="yy"
                                inputId="yearpicker" [showIcon]="true" (ngModelChange)="FilterByYear()"></p-calendar>
                        </div>
                    </div>

                    <div class="col text-right pt-0 d-flex justify-content-end pr-0 gap-3">
                        <!-- <span class="mr-2 countrequest"></span> -->
                       
                        <p-dropdown class="ct_input_white_bg13 ct_select_2_drop_white ct_input_dark_text_145 mr-3 et_dropdown_li_left_w_g_b"
                        [options]="buttonOptions" [(ngModel)]="action" [ngModelOptions]="{standalone: true}"
                        optionLabel="label" optionValue="value"  (onChange)="changeHandler()"></p-dropdown>
                   
                        <button  (click)="sendAction(this.action)" class="btn btn-sm SendforApproval-button text-white mb-0 mr-2"
                    style="border:1px solid  #88AD47;">
                    Submit
                </button>
                    </div>
                </div>

                <div class="p-0 m-0 view-request-div table-responive cd_requst__static12">

                    <p-table class="ct_bottom_table_tr et_table_spacing_12 ct_chev_icon_dark230" #dt [(selection)]="selectedEntry" [scrollable]="true" 
                        [globalFilterFields]="['catName']" dataKey="id" [rowsPerPageOptions]="[10, 25, 50]" 
                        [rowHover]="true"
                        [globalFilterFields]="['catName', 'subcatName', 'year', 'month', 'readingValue', 'unit', 'status']"
                        [value]="dataEntriesPending" [paginator]="true" [rows]="rows" editMode="row" [first]="indexPage" (onPage)="onPageChange($event)">

                        <ng-template pTemplate="header">
                            <tr>
                                <th>
                                    <input class="ct_input_checkbox_1234"
                                    type="checkbox"
                                    [checked]="allSelected"
                                    (change)="toggleSelectAll($event)"
                                  />
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 8">
                                    Type of purchase
                                   
                                </th>
                                <th pTooltip="Data Points" tooltipPosition="top" pSortableColumn="subcatName"
                                *ngIf="selectedCategory == 1 || selectedCategory == 2 || selectedCategory == 3 || selectedCategory == 4 || selectedCategory == 5 || selectedCategory == 6">
                                D.P
                             
                            </th>
                                <th pSortableColumn="catName"
                                    *ngIf="selectedCategory != 24 && selectedCategory != 25 && selectedCategory != 26">
                                    Category
                                   
                                </th>
                                <th *ngIf="selectedCategory == 7" pSortableColumn="type">
                                    Type
                                   
                                </th>
                                <!-- <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Water Treatment
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Water Supply
                                   
                                </th> -->
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Total Water withdrawn
                                    <!-- -->
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Surface water (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Groundwater (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Third party (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Sea water / desalinated water (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Others (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Total Water discharged

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Surface water (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Groundwater (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Third party (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Sea water / desalinated water (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Others (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Total Water Treated

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Surface water (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Treatment

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Groundwater (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Treatment

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Third party (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Treatment

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Sea water / desalinated water (%)

                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Treatment


                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Others (%)


                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 11">
                                    Treatment


                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 20">
                                    Combustion
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 20">
                                    Composing
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 20">
                                    Landfill
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 20">
                                    Recycling
                                   
                                </th>
                                <th pSortableColumn="catName"
                                    *ngIf="selectedCategory == 16 || selectedCategory == 21 || selectedCategory == 22 || selectedCategory == 23">
                                    Sub Category
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 18">
                                    Sub Activity
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 23">
                                    Investment type
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 18">
                                    Processing Activity
                                   
                                </th>
                                <th pSortableColumn="catName"
                                    *ngIf="selectedCategory == 16 || selectedCategory ==18 || selectedCategory == 21 ||selectedCategory == 22 ||selectedCategory == 23">
                                    Calculation Method
                                   
                                </th>
                                <th pSortableColumn="catName"
                                    *ngIf="selectedCategory == 16 || selectedCategory == 21 ||selectedCategory == 22">
                                    Franchise Space
                                   
                                </th>
                                <th pSortableColumn="catName"
                                    *ngIf="selectedCategory == 16 || selectedCategory ==18 || selectedCategory == 21 ||selectedCategory == 22">
                                    Scope 1 Emission
                                   
                                </th>
                                <th pSortableColumn="catName"
                                    *ngIf="selectedCategory == 16 || selectedCategory ==18 || selectedCategory == 21 ||selectedCategory == 22">
                                    Scope 2 Emission
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 15">
                                    Type of Home Office
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 15">
                                    No of days
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 15">
                                    No of employees
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 15">
                                    No of months
                                  
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 14">
                                    Type
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 14">
                                    % of Employee Commute
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 14">
                                    Average Commuted Distance (km)
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 14">
                                    Working Days
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 10 || selectedCategory == 17">
                                    Vehicle Type
                                    
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 12">
                                    Method
                                  
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 12">
                                    Waste Type
                                  
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 10 || selectedCategory == 17">
                                    Sub Category
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 10 || selectedCategory == 17">
                                    Distance Travelled
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 10 || selectedCategory == 17">
                                    Mass of Product
                                   
                                </th>
                                <th pSortableColumn="catName" *ngIf="selectedCategory == 10 || selectedCategory == 17">
                                    Storage facility
                                   
                                </th>
                              
                                <th pSortableColumn="flightMode" *ngIf="selectedCategory == 13 && this.selectMode == 1">
                                    Flight mode
                                    <p-sortIcon field="flightMode"></p-sortIcon>
                                </th>
                                <th pSortableColumn=" FlightType" *ngIf="selectedCategory == 13 && this.selectMode == 1">
                                    Flight Type
                                    <p-sortIcon field=" FlightType"></p-sortIcon>
                                </th>
                                <th pSortableColumn="Class" *ngIf="selectedCategory == 13 && this.selectMode == 1">
                                    Flight Class
                                    <p-sortIcon field="Class"></p-sortIcon>
                                </th>
                                <th pSortableColumn="Nooftrips" *ngIf="selectedCategory == 13 && this.selectMode == 1">
                                    No of Trips
                                    <p-sortIcon field="Nooftrips"></p-sortIcon>
                                </th>
                                <!-- <th pSortableColumn="Distance" *ngIf="selectedCategory == 24">
                                    Distance Travelled
                                    <p-sortIcon field="Distance"></p-sortIcon>
                                </th> -->
                                <th pSortableColumn="Countryofstay" *ngIf="selectedCategory == 13 && this.selectMode == 2">
                                    Country of Stay
                                    <p-sortIcon field="Countryofstay"></p-sortIcon>
                                </th>

                                <th pSortableColumn="typeHotel" *ngIf="selectedCategory == 13 && this.selectMode == 2">
                                    Type of Sotel
                                    <p-sortIcon field="typeHotel"></p-sortIcon>
                                </th>
                                <th pSortableColumn="no_of_occupied_rooms" *ngIf="selectedCategory == 13 && this.selectMode == 2">
                                    Occupied Rooms
                                    <p-sortIcon field="no_of_occupied_rooms"></p-sortIcon>
                                </th>
                                <th pSortableColumn="no_of_nights_per_room" *ngIf="selectedCategory == 13 && this.selectMode == 2">
                                    Nights per Room
                                    <p-sortIcon field="no_of_nights_per_room"></p-sortIcon>
                                </th>

                                <th pSortableColumn="no_of_nights_per_room" *ngIf="selectedCategory == 13 && this.selectMode == 3">
                                    Mode of Trasport
                                    <p-sortIcon field="no_of_nights_per_room"></p-sortIcon>
                                </th>
                                <th pSortableColumn="no_of_nights_per_room" *ngIf="selectedCategory == 13 && this.selectMode == 3">
                                    No. of Passengers
                                    <p-sortIcon field="no_of_nights_per_room"></p-sortIcon>
                                </th>
                                <th pSortableColumn="distanceT" *ngIf="selectedCategory == 13 && this.selectMode == 3">
                                    Distance Travlled
                                    <p-sortIcon field="distanceT"></p-sortIcon>
                                </th>
                                <th pSortableColumn="no_of_trips" *ngIf="selectedCategory == 13 && this.selectMode == 3">
                                    No of Trips
                                    <p-sortIcon field="no_of_trips"></p-sortIcon>
                                </th>


                                <th pSortableColumn="year">
                                    <p-sortIcon field="year"></p-sortIcon>
                                    Year
                                    <!-- <p-columnFilter field="year" matchMode="equals" display="menu" [showMenu]="true"
                                        [showMatchModes]="false" [showOperator]="false" [showAddButton]="false">
                                        <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                            <p-dropdown [ngModel]="value" [options]="yearOptions"
                                                (onChange)="filter($event.value)" placeholder="All" [showClear]="false">
                                            </p-dropdown>
                                        </ng-template>
                                    </p-columnFilter> -->
                                </th>
                                <th pSortableColumn="month"
                                    *ngIf="selectedCategory!=8 && selectedCategory!=14 && selectedCategory!=15">
                                    Month
                                    <p-sortIcon field="month"></p-sortIcon>
                                </th>
                                <th *ngIf="selectedCategory==1 || selectedCategory==5 || selectedCategory==7 || selectedCategory==8"
                                    pTooltip="Reading Value" tooltipPosition="top" pSortableColumn="readingValue">
                                    <p-sortIcon field="readingValue"></p-sortIcon>
                                    Value

                                </th>
                                <th *ngIf="selectedCategory==1" pTooltip="Blend Type" tooltipPosition="top"
                                    pSortableColumn="BlendType">
                                    <p-sortIcon field="BlendType"></p-sortIcon>
                                    Blend

                                </th>
                                <!-- <th *ngIf="selectedCategory==1" style="width: 15%" pTooltip="Blend percent"
                                    tooltipPosition="top" pSortableColumn="blendPercent">
                                    <p-sortIcon field="blendPercent"></p-sortIcon>
                                    %

                                </th> -->
                                <th *ngIf="selectedCategory==2" pSortableColumn="noofairconnUnits"
                                    pTooltip="Amount of refrigent used" tooltipPosition="top">
                                    Refrigerant Amount <p-sortIcon field="noofairconnUnits"></p-sortIcon>
                                </th>
                                <th *ngIf="selectedCategory==3" pSortableColumn="numberOfExtinguisher"
                                    pTooltip="Number Of Fire Extinguisher" tooltipPosition="top">
                                    Extinguisher <p-sortIcon field="numberOfExtinguisher"></p-sortIcon>
                                </th>
                                <th *ngIf="selectedCategory==3" pSortableColumn="quantityOfCO2makeup"
                                    pTooltip="Quantity Of CO2 makeup" tooltipPosition="top">
                                    CO2 MakeUp <p-sortIcon field="quantityOfCO2makeup"></p-sortIcon>
                                </th>
                                <th *ngIf="selectedCategory==6" pSortableColumn="noOfVehicles" pTooltip="Vehicle Type"
                                    tooltipPosition="top">
                                    Type <p-sortIcon field="noOfVehicles"></p-sortIcon>
                                </th>
                                <th *ngIf="selectedCategory==6" pSortableColumn="noOfVehicles"
                                    pTooltip="Number Of Vehicles" tooltipPosition="top">
                                    Vehicles <p-sortIcon field="noOfVehicles"></p-sortIcon>
                                </th>
                                <th *ngIf="selectedCategory==6" pSortableColumn="modeOfDE" pTooltip="Mode Of data entry"
                                    tooltipPosition="top">
                                    Mode <p-sortIcon field="modeOfDE"></p-sortIcon>
                                </th>
                                <th *ngIf="selectedCategory==6" pSortableColumn="amount">
                                    Value <p-sortIcon field="amount"></p-sortIcon>
                                </th>
                                <th pSortableColumn="unit"
                                    *ngIf="selectedCategory !=24 && selectedCategory !=25  && selectedCategory !=26">
                                    Unit <p-sortIcon field="unit"></p-sortIcon>
                                </th>



                                <th *ngIf="selectedCategory==5" pSortableColumn="sourceName">
                                    Source <p-sortIcon field="sourceName"></p-sortIcon>
                                </th>
                                <th >
                                    <p-sortIcon pSortableColumn="status" field="status"></p-sortIcon>
                                    Status
                                    <p-columnFilter field="status" matchMode="equals" display="menu" [showMenu]="true"
                                        [showMatchModes]="false" [showOperator]="false" [showAddButton]="false">
                                        <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                            <p-dropdown [ngModel]="value" [options]="statusOptions"
                                                (onChange)="filter($event.value)" placeholder="All" [showClear]="false">
                                            </p-dropdown>
                                        </ng-template>
                                    </p-columnFilter>

                                </th>
                                <th pSortableColumn="sourceName" pTooltip="tCO2" tooltipPosition="top">
                                    Emission
                                </th>
                                <th >
                                    User
                                </th>
                                <th>Action</th>
                                <!-- <th >Details</th> -->
                            </tr>

                        </ng-template>
                        <ng-template pTemplate="body" let-de let-editing="editing" let-ri="rowIndex">
                            <tr [pEditableRow]="de">
                                <td>
                                    <p-tableCheckbox  [value]="de"></p-tableCheckbox>
                                    <label class="sendLable" *ngIf="
                                            de.sendForApproval === true &&
                                            loginInfo.role === Preparer &&
                                            de.status === Pending
                                        ">Sent for Approval</label>
                                </td>
                                <td *ngIf="selectedCategory == 8"> {{de.typeofpurchase}}</td>
                                <td
                                    *ngIf="selectedCategory != 24 && selectedCategory != 16 && selectedCategory !=18 && selectedCategory !=20 && selectedCategory !=21   && selectedCategory !=22 && selectedCategory !=23 && selectedCategory != 25 && selectedCategory != 26">
                                    {{ de.catName }}</td>

                                <!-- <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_supply }}</td> -->
                                <td *ngIf="selectedCategory == 11 ">
                                    {{de.water_supply}}</td>
                                <td *ngIf="selectedCategory == 11 ">{{
                                    de.water_withdrawl_by_source[0].totalwaterwithdrawl }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{
                                    de.water_withdrawl_by_source[1].totalwaterwithdrawl }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{
                                    de.water_withdrawl_by_source[2].totalwaterwithdrawl }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{
                                    de.water_withdrawl_by_source[3].totalwaterwithdrawl }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{
                                    de.water_withdrawl_by_source[4].totalwaterwithdrawl }}</td>
                                <td *ngIf="selectedCategory == 11">
                                    {{de.water_discharged_value}}
                                </td>

                                <td *ngIf="selectedCategory == 11 ">{{ de.water_discharge[0].totaldischarge }}
                                </td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_discharge[1].totaldischarge }}
                                </td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_discharge[2].totaldischarge }}
                                </td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_discharge[3].totaldischarge }}
                                </td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_discharge[4].totaldischarge }}
                                </td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[0].totalwaterdischarge
                                    +de.water_treatment[1].totalwaterdischarge+
                                    de.water_treatment[2].totalwaterdischarge+
                                    de.water_treatment[3].totalwaterdischarge +
                                    de.water_treatment[4].totalwaterdischarge }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[0].totalwaterdischarge
                                    }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[0].leveloftreatment }}
                                </td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[1].totalwaterdischarge
                                    }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[1].leveloftreatment }}
                                </td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[2].totalwaterdischarge
                                    }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[2].leveloftreatment }}
                                </td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[3].totalwaterdischarge
                                    }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[3].leveloftreatment }}
                                </td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[4].totalwaterdischarge
                                    }}</td>
                                <td *ngIf="selectedCategory == 11 ">{{ de.water_treatment[4].leveloftreatment }}
                                </td>
                                <td *ngIf="selectedCategory == 23 ">{{ de.category }}</td>
                                <td *ngIf="selectedCategory == 22 ">{{ de.franchise_type }}</td>
                                <td *ngIf="selectedCategory == 22 || selectedCategory == 23  ">{{ de.sub_category }}
                                </td>
                                <td *ngIf="selectedCategory == 7"> {{de.type}}</td>
                                <td *ngIf="selectedCategory == 20 ">{{ de.subcategory }}</td>
                                <td *ngIf="selectedCategory == 20 ">{{ de.combustion }}</td>
                                <td *ngIf="selectedCategory == 20 ">{{ de.composing }}</td>
                                <td *ngIf="selectedCategory == 20 ">{{ de.landfill }}</td>
                                <td *ngIf="selectedCategory == 20 ">{{ de.recycling }}</td>
                                <td *ngIf="selectedCategory == 16 || selectedCategory == 21 ">{{ de.category }}</td>
                                <td *ngIf="selectedCategory == 18">{{ de.intermediate_category }}</td>
                                <td *ngIf="selectedCategory == 18">{{ de.sub_activity }}</td>
                                <td *ngIf="selectedCategory == 18">{{ de.processing_acitivity }}</td>
                               
                                <td *ngIf="selectedCategory == 16 || selectedCategory == 21">{{ de.sub_category }}</td>
                                <td *ngIf="selectedCategory == 23">{{ de.investement_type }}</td>
                                <td
                                    *ngIf="selectedCategory == 16 || selectedCategory ==18 || selectedCategory == 21 ||selectedCategory == 22 ||selectedCategory == 23">
                                    {{ de.calculation_method }}</td>
                                <td *ngIf="selectedCategory == 16 || selectedCategory == 21 ||selectedCategory ==22">{{
                                    de.franchise_space }}</td>
                                <td *ngIf="selectedCategory == 18 ">{{ de.scope1emissions }}</td>
                                <td *ngIf="selectedCategory == 18 ">{{ de.scope2emissions }}</td>

                                <td
                                    *ngIf="selectedCategory == 16 || selectedCategory == 21 || selectedCategory == 22   ">
                                    {{
                                    de.scope1_emission }}</td>
                                <td
                                    *ngIf="selectedCategory == 16 || selectedCategory == 21 || selectedCategory == 22  ">
                                    {{
                                    de.scope2_emission }}</td>
                                <td *ngIf="selectedCategory == 15">{{ de.typeof_homeoffice_name }}</td>
                                <td *ngIf="selectedCategory == 15">{{ de.noofdays }}</td>
                                <td *ngIf="selectedCategory == 15">{{ de.noofemployees }}</td>
                                <td *ngIf="selectedCategory == 15">{{ de.noofmonths }}</td>
                                <td *ngIf="selectedCategory == 14">{{de.category_name}}-{{ de.type }}</td>
                                <td *ngIf="selectedCategory == 14">{{ de.allemployeescommute }}</td>
                                <td *ngIf="selectedCategory == 14">{{ de.avgcommutedistance }}</td>
                                <td *ngIf="selectedCategory == 14">{{ de.workingdays }}</td>
                                <td *ngIf="selectedCategory == 12">{{ de.method }}</td>
                                <td *ngIf="selectedCategory == 12">{{ de.waste_type }}</td>
                                <td
                                    *ngIf="selectedCategory != 8 && selectedCategory != 2 && selectedCategory != 7 && selectedCategory != 10 && selectedCategory != 12 && selectedCategory != 13 && selectedCategory != 14 && selectedCategory != 15 && selectedCategory != 16 && selectedCategory != 17 && selectedCategory != 18 && selectedCategory != 19 && selectedCategory != 20 && selectedCategory !=21 && selectedCategory !=22 && selectedCategory !=11 && selectedCategory !=23 && selectedCategory !=24 && selectedCategory != 25 && selectedCategory != 26">
                                    {{ de.subcatName }}</td>
                                    <td *ngIf="selectedCategory == 2">{{ de.TypeName }}</td>
                                <td *ngIf="selectedCategory == 10 || selectedCategory == 17">{{ de.vehicle_type_name }}</td>
                                <td *ngIf="selectedCategory == 10 || selectedCategory == 17">{{ de.sub_category }}</td>
                                <td *ngIf="selectedCategory == 10 || selectedCategory == 17">{{ de.distance_travelled_km
                                    }}
                                </td>
                                <td *ngIf="selectedCategory == 10 || selectedCategory == 17">{{ de.mass_of_product_trans
                                    }}
                                </td>
                                <td *ngIf="selectedCategory == 10 || selectedCategory == 17">{{ de.storage_facility_type
                                    }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==1">{{ de.flight_calc_mode }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==1">{{ de.flight_Type }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==1">{{ de.flight_Class }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==1">{{ de.no_of_trips }}
                                </td>
                                <!-- <td *ngIf="selectedCategory == 24">{{ de.distance }}
                                </td> -->
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==2">{{ de.country_of_stay }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==2">{{ de.type_of_hotel }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==2">{{ de.no_of_occupied_rooms }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==2">{{ de.no_of_nights_per_room }}
                                </td>

                                <td *ngIf="selectedCategory == 13 && this.selectMode ==3">{{ de.mode_of_trasport }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==3">{{ de.no_of_passengers }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==3">{{ de.distance_travelled }}
                                </td>
                                <td *ngIf="selectedCategory == 13 && this.selectMode ==3">{{ de.no_of_trips }}
                                </td>
                                <td>
                                    {{ de.year }}
                                </td>
                                <td *ngIf="selectedCategory != 8 && selectedCategory != 14 && selectedCategory != 15">
                                    {{ de.month }}
                                </td>
                                <td *ngIf="selectedCategory==1 || selectedCategory==5 || selectedCategory==7">
                                    <p-cellEditor><ng-template pTemplate="input">
                                            <input name="readingValue_{{ ri }}" id="{{ ri }}" pInputText type="text"
                                                [(ngModel)]="de.readingValue" ngModel #readingValue="ngModel">
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{ de.readingValue }}
                                        </ng-template>{{ de.readingValue }}</p-cellEditor>
                                </td>
                                <td *ngIf="selectedCategory==1">{{ de.blendType }}</td>
                                <td *ngIf="selectedCategory==8">{{ de.valuequantity }}</td>
                               
                                <td *ngIf="selectedCategory==3"><p-cellEditor><ng-template pTemplate="input">
                                            <input name="numberOfExtinguisher_{{ ri }}" id="{{ ri }}" pInputText
                                                type="text" [(ngModel)]="de.numberOfExtinguisher" ngModel
                                                #numberOfExtinguisher="ngModel">
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{ de.numberOfExtinguisher }}
                                        </ng-template>{{ de.numberOfExtinguisher }}</p-cellEditor></td>
                                <td *ngIf="selectedCategory==3"><p-cellEditor><ng-template pTemplate="input">
                                            <input name="quantityOfCO2makeup_{{ ri }}" id="{{ ri }}" pInputText
                                                type="text" [(ngModel)]="de.quantityOfCO2makeup" ngModel
                                                #quantityOfCO2makeup="ngModel">
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{ de.quantityOfCO2makeup }}
                                        </ng-template>{{ de.quantityOfCO2makeup }}</p-cellEditor></td>
                                <td *ngIf="selectedCategory==2"><p-cellEditor><ng-template pTemplate="input">
                                            <input name="refAmount_{{ ri }}" id="{{ ri }}" pInputText type="text"
                                                [(ngModel)]="de.refAmount" ngModel #refAmount="ngModel">
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{ de.refAmount }}
                                        </ng-template>{{ de.refAmount }}</p-cellEditor></td>
                                <td *ngIf="selectedCategory==6">{{ de.vehicleTypeID }}</td>
                                <td *ngIf="selectedCategory==6">{{ de.NoOfVehicles }}</td>
                                <td *ngIf="selectedCategory==6">{{ de.ModeofDEID }}</td>
                                <td *ngIf="selectedCategory==6">{{ de.Value }}</td>
                                <td *ngIf="selectedCategory !=24 && selectedCategory !=25  && selectedCategory !=26">{{
                                    de.unit }}</td>


                                <td *ngIf="selectedCategory==5">{{ de.SourceName }}</td>
                                <td>
                                    <div class="d-flex text-white justify-content-center">
                                        <span [ngClass]="{
                                                Rejected:
                                                    de.status === Rejected,
                                                Pending: de.status === Pending,
                                                Approved: de.status === Approved
                                            }">{{ de.status }}</span>
                                        <span *ngIf="de.status === Rejected && loginInfo.role !== Approver"
                                            class="pt-2 pl-1"><i class="pi pi-comment pointer"
                                                (mouseover)="op.toggle($event)"
                                                (mouseleave)="op.toggle($event)"></i></span>
                                    </div>

                                    <p-overlayPanel #op>
                                        <p>{{ de.Reason }}</p>
                                    </p-overlayPanel>
                                </td>
                                <td>{{ de.emission | number :'1.4-4' }}</td>

                                
                                <td>{{ de.user_name }}</td>

                                <td>

                                 
                                    <div *ngIf="
                                    de.status === Pending
                                 " class="d-flex font-pera text-center pl-3 pt-0">
                                        <button type="button"
                                            class="btn btn-dark margin ct_view_request_action_btn_green"
                                            data-bs-toggle="modal" data-bs-target="#viewModal"
                                            ngbTooltip="Accept / Reject" (click)="onUpdateUserStatus(de)">
                                            <i class="fa fa-eject" aria-hidden="true"></i>
                                        </button>

                                        <p-dialog header="Header" [(visible)]="visible" [style]="{width: '50vw'}">
                                            <ng-template pTemplate="header">
                                                <span class="text-xl font-bold mx-auto">Reason</span>
                                            </ng-template>

                                            <label class="py-2">Please enter Reason for reject
                                                entry</label>
                                            <div class="pl-5">
                                                <textarea name="reason" rows="5" class="ct_textarea_full" pInputTextarea
                                                    [(ngModel)]="de.reason" #inputreason="ngModel" required></textarea>
                                                <p class="text-danger mb-0" *ngIf="inputreason.errors?.['required']">
                                                    reason is required
                                                </p>
                                            </div>

                                           
                                        </p-dialog>
                                    </div>
                                    <label class="sendLable" *ngIf="
                                            de.sendForApproval === true &&
                                            loginInfo.role === Preparer &&
                                            de.status === Pending
                                        ">Sent for Approval</label>
                                </td>
                                <!-- <td>
                                    <div class="view-details">
                                        <i class="pi pi-eye pt-2 text-white" title="info"
                                            [routerLink]="['/tracking-status']"
                                            [queryParams]="{data:de.subselectedCategory}"></i>
                                        <a *ngIf="de.fileName" (click)="downloadFile(de.fileName)">
                                            <i class="pi pi-download text-white pl-2" title="download"></i></a>
                                    </div>
                                </td> -->
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </form>
        </div>
    </div>
</div>


<div class="modal fade show" id="myModal" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true"
    [ngStyle]="{'display':display}">
    <div class="modal-dialog ct_modal_center_120">
        <div class="modal-content ct_modal_main_div140 ">
            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">Update Status</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="closePopup"
                    (click)="onClose2()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <p>Would you like to accept or reject?</p>
                <button type="button" class="btn btn-primary text-white" id="acceptBtn"
                    (click)="AcceptSingleEntry()">Approve</button>
                <button type="button" class="btn btn-danger ml-2 text-white" id="rejectBtn"
                    (click)="RejectSingleEntry()">Reject</button>
            </div>

            <!-- Modal Footer -->

        </div>
    </div>
</div>
<div class="modal fade show" id="myModal" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true"
    [ngStyle]="{'display':display2}">
    <div class="modal-dialog ct_modal_center_120">
        <div class="modal-content ct_modal_main_div140 ">
            <!-- Modal Header -->
            <div class="modal-header">
                <h5 class="modal-title text-danger font-weight-bold">Delete Confirmation</h5>
                <button type="button" class="close" aria-label="Close" (click)="onClose2()">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              
              <div class="modal-body text-center">
                <p class="mb-4">Are you sure you want to delete all approved items?</p>
                <button type="button" class="btn btn-outline-secondary" (click)="onClose2()">Cancel</button>
                <button type="button" class="btn btn-danger ml-2" (click)="sendEntires(this.action)">Delete</button>
              </div>

            <!-- Modal Footer -->

        </div>
    </div>
</div>